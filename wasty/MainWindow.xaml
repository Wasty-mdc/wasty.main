<Window x:Class="wasty.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="clr-namespace:wasty.ViewModels"
        xmlns:views="clr-namespace:wasty.Views"
        xmlns:md="http://materialdesigninxaml.net/winfx/xaml/themes"
        xmlns:shell="clr-namespace:System.Windows.Shell;assembly=PresentationFramework"
        Title="Wasty"
        WindowState="Normal"
        Background="Transparent"
        WindowStyle="None"
        ResizeMode="CanResize"
        AllowsTransparency="False">

    <shell:WindowChrome.WindowChrome>
        <shell:WindowChrome 
            CaptionHeight="40"
            ResizeBorderThickness="8"
            CornerRadius="12"
            GlassFrameThickness="0"
            UseAeroCaptionButtons="True"/>
    </shell:WindowChrome.WindowChrome>
    
    <!-- Recursos -->
    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="Styles/mainStyles.xaml"/>
            </ResourceDictionary.MergedDictionaries>
            <BooleanToVisibilityConverter x:Key="BoolToVisConverter"/>
        </ResourceDictionary>
    </Window.Resources>
    <Border x:Name="MainBorder" Background="{StaticResource MainGradientBackground}" shell:WindowChrome.IsHitTestVisibleInChrome="True">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="32"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Barra personalizada -->
            <Border Background="#1C1C1C" Height="32" MouseLeftButtonDown="Barra_MouseLeftButtonDown" shell:WindowChrome.IsHitTestVisibleInChrome="True" >
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <!-- Logo + nombre -->
                    <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Grid.Column="0" Margin="10,0,0,0">
                        <TextBlock Text="Wasty" VerticalAlignment="Center" Foreground="White" Style="{StaticResource TextM}" Margin="0,0,10,0"/>
                    </StackPanel>

                    <!-- Botones navegación -->
                    <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Grid.Column="1">
                        <Button Style="{StaticResource MaterialDesignToolButton}" Margin="0,0,4,0" VerticalAlignment="Center">
                            <md:PackIcon Kind="ArrowLeft" Width="20" Height="20"/>
                        </Button>
                        <Button Style="{StaticResource MaterialDesignToolButton}" VerticalAlignment="Center">
                            <md:PackIcon Kind="ArrowRight" Width="20" Height="20"/>
                        </Button>
                    </StackPanel>

                    <!-- Botones de acciones -->
                    <Grid Grid.Column="3" VerticalAlignment="Stretch" HorizontalAlignment="Right">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="36"/>
                            <ColumnDefinition Width="36"/>
                            <ColumnDefinition Width="36"/>
                        </Grid.ColumnDefinitions>

                        <!-- Minimizar -->
                        <Button Style="{StaticResource AnimatedWindowButtonStyle}" Grid.Column="0" Click="Minimizar_Click">
                            <md:PackIcon Kind="WindowMinimize" Width="16" Height="16" Foreground="White"/>
                        </Button>

                        <!-- Maximizar -->
                        <Button x:Name="BtnMaximize" Style="{StaticResource AnimatedWindowButtonStyle}" Grid.Column="1" Click="MaximizarRestaurar_Click">
                            <md:PackIcon x:Name="MaxRestoreIcon" Kind="WindowMaximize" Width="16" Height="16" Foreground="White"/>
                        </Button>

                        <!-- Cerrar -->
                        <Button Style="{StaticResource AnimatedCloseButtonStyle}" Grid.Column="2" Click="Cerrar_Click">
                            <md:PackIcon Kind="Close" Width="18" Height="18" Foreground="White"/>
                        </Button>
                    </Grid>
                </Grid>
            </Border>

            <!-- Contenido de la app -->
            <Grid Grid.Row="1">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="70"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- Navegación lateral -->
                <Grid Grid.Column="0" Background="{StaticResource NavColor}" Visibility="{Binding IsAuthenticated, Converter={StaticResource BoolToVisConverter}}">
                    <StackPanel Width="70" VerticalAlignment="Stretch" HorizontalAlignment="Left">
                        <Button Style="{StaticResource NavButton}" ToolTip="Inicio" Command="{Binding ShowMainViewCommand}">
                            <md:PackIcon Kind="Home" Width="30" Height="30" Foreground="White"/>
                        </Button>
                        <Button Style="{StaticResource NavButton}" ToolTip="Historial">
                            <md:PackIcon Kind="BellBadgeOutline" Width="30" Height="30" Foreground="White"/>
                        </Button>
                        <Button Style="{StaticResource NavButton}" ToolTip="Favoritos">
                            <md:PackIcon Kind="Star" Width="30" Height="30" Foreground="White"/>
                        </Button>
                    </StackPanel>

                    <StackPanel Width="60" VerticalAlignment="Bottom" HorizontalAlignment="Center" Margin="0,0,0,20">
                        <Button Style="{StaticResource NavButtonDown}" ToolTip="Configuración">
                            <md:PackIcon Kind="Cog" Width="30" Height="30" Foreground="White"/>
                        </Button>
                        <Button Style="{StaticResource NavButtonDown}" ToolTip="Perfil">
                            <md:PackIcon Kind="Account" Width="30" Height="30" Foreground="White"/>
                        </Button>
                        <Button Style="{StaticResource NavButtonDown}" ToolTip="Salir" Command="{Binding ShowLoginViewCommand}">
                            <md:PackIcon Kind="Logout" Width="30" Height="30" Foreground="White"/>
                        </Button>
                    </StackPanel>
                </Grid>

                <!-- Vista dinámica -->
                <Grid Grid.Column="1" Background="{StaticResource MainGradientBackground}">
                    <ContentControl Content="{Binding CurrentView}" Name="CurrentView" Background="Transparent"/>
                </Grid>
            </Grid>
        </Grid>
    </Border>
</Window>
